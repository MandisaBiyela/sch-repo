{% extends "admin_base.html" %}

{% block content %}
  <!-- Add New Book Section -->
  <section id="add-book">
    <h2 class="text-2xl font-bold mb-6">Add New Book</h2>
    <div class="bg-white rounded-lg shadow-md p-6">
        <form method="POST" action="{{ url_for('admin.add_book') }}" enctype="multipart/form-data">


            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="barcode">
                        Barcode <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="barcode" name="barcode" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="title">
                        Title <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="title" name="title" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="author">
                        Author <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="author" name="author" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="price">
                        Price <span class="text-red-500">*</span>
                    </label>
                    <input type="number" id="price" name="price" step="0.01" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="format">
                        Format <span class="text-red-500">*</span>
                    </label>
                    <select id="format" name="format" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select format</option>
                        <option value="PDF">PDF</option>
                        <option value="Physical">Physical</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="condition">
                        Condition <span class="text-red-500">*</span>
                    </label>
                    <select id="condition" name="condition" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select condition</option>
                        <option value="New">New</option>
                        <option value="Second-hand">Second-hand</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="stock">
                        Stock Quantity <span class="text-red-500">*</span>
                    </label>
                    <input type="number" id="stock" name="stock" min="0" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-gray-700 font-medium mb-2" for="description">
                    Description
                </label>
                <textarea id="description" name="description" rows="4"
                    class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
            </div>

            <div class="mb-6">
                <label class="block text-gray-700 font-medium mb-2" for="image">
                    Book Cover Image
                </label>
                <div class="flex flex-col md:flex-row md:items-center md:space-x-4">
                    <div class="w-40 h-48 bg-gray-100 flex items-center justify-center border rounded-lg overflow-hidden mb-4 md:mb-0">
                        <img id="preview-image" src="/api/placeholder/150/200" alt="Book Cover Preview"
                            class="max-h-full max-w-full hidden">
                        <div id="upload-placeholder" class="text-center p-4">
                            <i class="fas fa-image text-gray-400 text-4xl mb-2"></i>
                            <p class="text-sm text-gray-500">No image selected</p>
                        </div>
                    </div>
                    <div class="flex-1">
                        <label
                            class="block w-full px-4 py-2 bg-blue-500 text-white rounded-lg text-center cursor-pointer hover:bg-blue-600">
                            <i class="fas fa-upload mr-2"></i> Upload Image
                            <input type="file" id="image" name="image" accept="image/*" class="hidden"
                                onchange="previewImage(this)">
                        </label>
                        <p class="text-sm text-gray-500 mt-2">
                            Recommended size: 600x800px. Max file size: 2MB.
                        </p>
                        <input type="text" id="image_url" name="image_url" placeholder="Or enter image URL"
                            class="w-full px-4 py-2 border rounded-lg mt-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-4 mt-6">
                <button type="button"
                    class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-300">
                    Cancel
                </button>
                <button type="submit" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Add Book
                </button>
            </div>
        </form>
    </div>
  </section>

  <script>
    function previewImage(input) {
      const preview = document.getElementById('preview-image');
      const placeholder = document.getElementById('upload-placeholder');
      
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          preview.src = e.target.result;
          preview.classList.remove('hidden');
          placeholder.classList.add('hidden');
        };
        
        reader.readAsDataURL(input.files[0]);
      }
    }
  </script>
{% endblock %}